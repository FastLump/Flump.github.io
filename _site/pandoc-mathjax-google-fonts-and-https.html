<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href='http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'>

  <title>Brian Buccola &middot; Pandoc, MathJax, Google fonts, and HTTPS</title>
  <meta name="description" content="tl;dr For any secure (https) webpage with URLs in its source code toGoogle fonts or MathJax, those URLs must also be secure (https); otherwise,the fonts, , e...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://brianbuccola.com/pandoc-mathjax-google-fonts-and-https">
  <link rel="alternate" type="application/rss+xml" title="Brian Buccola" href="http://brianbuccola.com/feed.xml">

  <!-- mathjax config similar to math.stackexchange -->
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <!-- <a class="site-title" href="/">Brian Buccola</a> -->

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/">Home</a>
        <a class="page-link" href="/about">About</a>
        <a class="page-link" href="/news">News</a>
        <a class="page-link" href="/work">Work</a>
        <a class="page-link" href="/files/buccola-cv.pdf">CV</a>
        <a class="page-link" href="/contact">Contact</a>
        <a class="page-link" href="/blog">Blog</a>
        <a class="page-link" href="/feed.xml"><span class="icon icon--feed"><?xml version="1.0"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> 
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="128px" height="128px" id="RSSicon" viewBox="0 0 256 256">
<defs>
<linearGradient x1="0.085" y1="0.085" x2="0.915" y2="0.915" id="RSSg">
<stop  offset="0.0" stop-color="#E3702D"/><stop  offset="0.1071" stop-color="#EA7D31"/>
<stop  offset="0.3503" stop-color="#F69537"/><stop  offset="0.5" stop-color="#FB9E3A"/>
<stop  offset="0.7016" stop-color="#EA7C31"/><stop  offset="0.8866" stop-color="#DE642B"/>
<stop  offset="1.0" stop-color="#D95B29"/>
</linearGradient>
</defs>
<rect width="256" height="256" rx="55" ry="55" x="0"  y="0"  fill="#CC5D15"/>
<rect width="246" height="246" rx="50" ry="50" x="5"  y="5"  fill="#F49C52"/>
<rect width="236" height="236" rx="47" ry="47" x="10" y="10" fill="url(#RSSg)"/>
<circle cx="68" cy="189" r="24" fill="#FFF"/>
<path d="M160 213h-34a82 82 0 0 0 -82 -82v-34a116 116 0 0 1 116 116z" fill="#FFF"/>
<path d="M184 213A140 140 0 0 0 44 73 V 38a175 175 0 0 1 175 175z" fill="#FFF"/>
</svg>
</span></a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Pandoc, MathJax, Google fonts, and HTTPS</h1>
    <p class="post-meta"><time datetime="2015-01-06T13:25:00+02:00" itemprop="datePublished">Jan 6, 2015</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><strong>tl;dr</strong> For any secure (<code class="highlighter-rouge">https</code>) webpage with URLs in its source code to
Google fonts or MathJax, those URLs must <em>also</em> be secure (<code class="highlighter-rouge">https</code>); otherwise,
the fonts, <script type="math/tex">\LaTeX{}</script>, etc. won’t render.</p>

<p>It’s been nearly a year since I last posted. One of my resolutions this year
(my dissertation year!) is to write more, including on this blog. Ideally I’d
write about semantics, but for now, just to get back into the swing of things,
I’ll be happy to write about anything. To that end, here’s a post.</p>

<p>I just upgraded <a href="http://johnmacfarlane.net/pandoc/">pandoc</a> yesterday and decided to rebuild my blog to see if
any changes would occur. (I write my blog in <a href="http://daringfireball.net/projects/markdown/">markdown</a> and then convert to
html using pandoc, so basically I reconverted all my posts markdown -&gt; html.)
Aside from the copyright changing from “2012–2014” to “2012–2015”, there was
only one subtle, but substantial change, and that has to do with <a href="http://www.mathjax.org/">MathJax</a>.</p>

<p>MathJax is “an open source JavaScript display engine for mathematics that works
in all browsers”. For example, it renders the html code <code class="highlighter-rouge">\(f(x) = x^2 + 4x -
3\)</code> into <script type="math/tex">f(x) = x^2 + 4x - 3</script>. The stuff between <code class="highlighter-rouge">\(...\)</code> is <script type="math/tex">\LaTeX{}</script>
code, and <code class="highlighter-rouge">\(...\)</code> are the delimiters that MathJax looks out for. But
actually, since I write my blog in markdown, I delimit <script type="math/tex">\LaTeX{}</script> code using
<code class="highlighter-rouge">$...$</code> (just like in <script type="math/tex">\LaTeX{}</script> itself) since that’s what <em>pandoc</em> looks out
for. In other words:</p>

<ol>
  <li>Write in markdown: <code class="highlighter-rouge">$f(x) = x^2 + 4x - 3$</code></li>
  <li>Markdown becomes html (via pandoc): <code class="highlighter-rouge">\(f(x) = x^2 + 4x -3\)</code></li>
  <li>Html becomes pretty (via mathjax): <script type="math/tex">f(x) = x^2 + 4x -3</script></li>
</ol>

<p>MathJax is run as a script within the html source code. All you need is
something like this, which links to some MathJax JavaScript:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://cdn.mathjax.org/mathjax/..."</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>
</div>

<p>(The full MathJax source URL is <a href="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">here</a>.)</p>

<p>The pandoc option <code class="highlighter-rouge">--mathjax</code> is supposed to automagically add the source URL,
and it did, until the recent pandoc update. After the update, I noticed that
the <code class="highlighter-rouge">http:</code> part was completely missing.
<a href="https://github.com/jgm/pandoc/issues/1847">Apparently</a>, this isn’t really a
bug; it was removed for principled reasons. The solution, I thought, was simply
to change from using <code class="highlighter-rouge">--mathjax</code> to explicitly using</p>

<div class="highlighter-rouge"><pre class="highlight"><code>--mathjax<span class="o">=</span><span class="s2">"http://cdn.mathjax.org/mathjax/..."</span>
</code></pre>
</div>

<p>I tried that, and it worked! At least, on my <em>local</em> copy of the blog
(<code class="highlighter-rouge">file:///home/brian/blog/...</code>). It did <em>not</em> work when I pushed the changes to
github (<code class="highlighter-rouge">http://brianbuccola.github.io/blog/...</code>). The MathJax wasn’t rendering
there. Huh.</p>

<p>I also noticed something else: my Google fonts were rendering on my local copy
of my blog, but not on the GitHub blog. Were the issues related? Yes, they
were. Here’s how.</p>

<p>I use the Firefox extension HTTPS-Everywhere, which tries to use the more
secure <code class="highlighter-rouge">https://blah.com/</code> instead of <code class="highlighter-rouge">http://blah.com/</code> whenever possible. It
turns out that when using the secure version of my blog,
<code class="highlighter-rouge">https://brianbuccola.github.io/</code>, any insecure (<code class="highlighter-rouge">http</code>) Google font URLs or
MathJax URLs <em>won’t work</em>. They need to all be changed to <code class="highlighter-rouge">https</code>. So that’s
what I did</p>

<div class="highlighter-rouge"><pre class="highlight"><code>--mathjax<span class="o">=</span><span class="s2">"https://cdn.mathjax.org/mathjax/..."</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.mathjax.org/mathjax/..."</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>
</div>

<p>and voilà, everything works again.</p>

<p>Moreover, using <code class="highlighter-rouge">https</code> URLs for Google fonts and MathJax <em>still</em> works when
using the normal <code class="highlighter-rouge">http</code> version of my blog. So as far as I can tell, there’s no
downside to always using the secure <code class="highlighter-rouge">https</code> URLs in your html source code, as
far as text rendering goes.</p>


  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="footer-wrapper">
      &copy; Brian Buccola. Powered by <a
         href="https://jekyllrb.com/">Jekyll</a> and <a
         href="https://github.com/">GitHub</a>.
    </div>
  </div>
</footer>


  </body>

</html>
